Flash Attention 2 not available: No module named 'flash_attn'
Xformers not available: No module named 'xformers'
Warning: flash-linear-attention not available, GatedDeltaNet will be slow
Note: fast_loader not installed. Install with: pip install git+https://github.com/Orolol/data-loader-fast.git

############################################################
# Data Loader Benchmark
# 2025-12-10 16:21:57
############################################################

Configuration:
  Model size: small
  Batch size: 2
  Block size: 128
  Num steps: 5
  Device: NVIDIA GeForce RTX 5090

Loading tokenizer...

============================================================
Benchmarking: Packed + DeltaNet
============================================================
Creating Packed + DeltaNet...
[PackedDataset Rank 0] Shuffling dataset with seed=0, buffer_size=5000
Creating fresh model (small) with GatedDeltaNet...
SWAMLA Model - Number of parameters: 352.06M
  - 0 SWA blocks, 4 MLA blocks
Waiting for prefetch buffer to fill...
Running 5 training steps...
Warmup (5 steps)...
Benchmarking...
[16:22:27] Closing packed data loader

============================================================
Data Loader Final Statistics:
  - Batches built: 522
  - Documents buffered: 0
  - Average padding ratio: 5.33%
  - Total tokens: 133,888
  - Total padding: 7,138
============================================================

[16:22:27] Packed data loader closed successfully

Packed + DeltaNet Results:
  Total time: 8.07s
  Total tokens: 1,139
  Tokens/sec: 141
  Avg step time: 1613.95ms
  Avg data time: 2.86ms (0.2%)
  Avg forward time: 534.09ms (33.1%)
  Avg backward time: 1076.99ms (66.7%)
  Avg loss: 10.7148
  Padding ratio: 5.33%

============================================================
SUMMARY
============================================================

Metric                 Packed + DeltaNet
----------------------------------------
Tokens/sec                           141
Avg step time (ms)               1613.95
Avg data time (ms)                  2.86
Padding ratio                      5.33%
Avg loss                         10.7148

============================================================
Winner: Packed + DeltaNet (0.0% faster than Packed + DeltaNet)
============================================================


[16:22:27] Received interrupt signal, cleaning up datasets...

[16:22:27] Received interrupt signal, cleaning up datasets...
